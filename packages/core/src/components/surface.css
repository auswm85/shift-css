/**
 * Shift CSS - Surface Component
 *
 * Adaptive surface with automatic contrast text color.
 * Uses semantic attribute selectors for depth/layering.
 *
 * Usage:
 *   <section s-surface>Default flat surface</section>
 *   <section s-surface="raised">Elevated card-like surface</section>
 *   <section s-surface="sunken">Recessed input-like surface</section>
 *   <section s-surface="floating">High elevation overlay</section>
 */

/* Base surface - zero specificity for easy overrides */
:where([s-surface]) {
  /* Enable container queries (size + style) */
  container-type: inline-size;
  container-name: surface;

  /* Surface CSS properties (customization points) */
  --_surface-bg: var(--s-surface-base);
  --_surface-padding: var(--s-space-4);
  --_surface-radius: var(--s-radius-lg);

  /* Depth indicator for style queries (flat=0, sunken=-1, raised=1, floating=2) */
  --_surface-depth: 0;

  background-color: var(--_surface-bg);
  padding: var(--_surface-padding);
  border-radius: var(--_surface-radius);

  /**
   * AUTO-CONTRAST TEXT COLOR
   *
   * Strategy (best to fallback):
   * 1. contrast-color() - CSS Color Level 6 (Chrome Canary, Safari TP)
   * 2. Relative color syntax - Extract lightness, threshold at L=0.6
   * 3. Semantic token fallback - Pre-defined light-dark() value
   */

  /* FALLBACK 1: Semantic token (works everywhere) */
  color: var(--s-text-primary);

  /* FALLBACK 2: Relative color syntax (2024+ browsers) */
  @supports (color: oklch(from red l c h)) {
    color: oklch(
      from var(--_surface-bg)
        /* If L < 0.55, use light text (0.95); otherwise dark text (0.15)
           Threshold 0.55 ensures 4.5:1 contrast per WCAG 2.1 AA */
        clamp(0.15, calc((0.55 - l) * 1000 + 0.15), 0.95) 0 0
    );
  }

  /* PRIMARY: contrast-color() (CSS Color Level 6 - 2025+ browsers) */
  @supports (color: contrast-color(red)) {
    color: contrast-color(var(--_surface-bg));
  }
}

/* =============================================================================
   SURFACE DEPTH VARIANTS
   ============================================================================= */

/* Flat - default, explicit declaration */
[s-surface="flat"] {
  --_surface-bg: var(--s-surface-base);
  --_surface-depth: 0;
}

/* Sunken - recessed appearance */
[s-surface="sunken"] {
  --_surface-bg: var(--s-surface-sunken);
  --_surface-depth: -1;
  box-shadow: var(--s-shadow-inner);
}

/* Raised - elevated card-like appearance */
[s-surface="raised"] {
  --_surface-bg: var(--s-surface-raised);
  --_surface-depth: 1;
  box-shadow: var(--s-shadow-md);
}

/* Floating - high elevation, for overlays and modals */
[s-surface="floating"] {
  --_surface-bg: var(--s-surface-raised);
  --_surface-depth: 2;
  box-shadow: var(--s-shadow-xl);
}

/* =============================================================================
   SURFACE MODIFIERS
   ============================================================================= */

/* Bordered surface */
[s-surface][s-bordered] {
  border: 1px solid var(--s-border-default);
}

/* Interactive surface (hoverable, focusable) */
[s-surface][s-interactive] {
  cursor: pointer;
  transition:
    transform var(--s-duration-150) var(--s-ease-out),
    box-shadow var(--s-duration-150) var(--s-ease-out);

  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--s-shadow-lg);
  }

  &:active {
    transform: translateY(0);
    box-shadow: var(--s-shadow-sm);
  }

  &:focus-visible {
    outline: 2px solid var(--s-focus-ring);
    outline-offset: 2px;
  }
}

/* =============================================================================
   COLOR VARIANTS
   ============================================================================= */

/* Brand color surfaces - use 700 shade (Lâ‰ˆ0.47) for WCAG 4.5:1 with white text */
/* Hex fallbacks for a11y tools that can't parse OKLCH */
[s-surface="primary"] {
  --_surface-bg: var(--s-primary-700);
  background-color: #0066aa; /* Fallback for OKLCH */
  background-color: var(--_surface-bg);
  color: #fff;
}

[s-surface="secondary"] {
  --_surface-bg: var(--s-secondary-700);
  background-color: #6644aa; /* Fallback for OKLCH */
  background-color: var(--_surface-bg);
  color: #fff;
}

[s-surface="accent"] {
  --_surface-bg: var(--s-accent-700);
  background-color: #aa4466; /* Fallback for OKLCH */
  background-color: var(--_surface-bg);
  color: #fff;
}

/* =============================================================================
   STATE SURFACES (for alerts, notifications)
   ============================================================================= */

/* State surfaces use light backgrounds with dark text for notification-style alerts */
/* Hex fallbacks for a11y tools that can't parse OKLCH/light-dark() */
[s-surface="success"] {
  --_surface-bg: var(--s-state-success-bg);
  background-color: #d4edda; /* Light green fallback */
  background-color: var(--_surface-bg);
  border-left: 4px solid var(--s-state-success);
  color: #1a1a1a;
}

[s-surface="warning"] {
  --_surface-bg: var(--s-state-warning-bg);
  background-color: #fff3cd; /* Light yellow fallback */
  background-color: var(--_surface-bg);
  border-left: 4px solid var(--s-state-warning);
  color: #1a1a1a;
}

[s-surface="danger"] {
  --_surface-bg: var(--s-state-danger-bg);
  background-color: #f8d7da; /* Light red fallback */
  background-color: var(--_surface-bg);
  border-left: 4px solid var(--s-state-danger);
  color: #1a1a1a;
}

/* =============================================================================
   CONTAINER QUERY RESPONSIVE PADDING
   ============================================================================= */

@container (max-width: 20rem) {
  :where([s-surface]) {
    --_surface-padding: var(--s-space-3);
  }
}

@container (min-width: 40rem) {
  :where([s-surface]) {
    --_surface-padding: var(--s-space-6);
  }
}
