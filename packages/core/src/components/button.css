/**
 * Shift CSS - Button Component
 *
 * Accessible button styles using semantic attribute selectors.
 * Uses s-btn attribute for variants and s-size for scaling.
 *
 * Usage:
 *   <button s-btn="primary">Primary</button>
 *   <button s-btn="secondary">Secondary</button>
 *   <button s-btn="ghost">Ghost</button>
 *   <button s-btn="primary" s-size="lg">Large Primary</button>
 */

/* Base button - zero specificity for easy overrides */
:where([s-btn]) {
  /* Button CSS properties (customization points) */
  --_btn-bg: var(--s-interactive-primary);
  --_btn-text: var(--s-text-inverse);
  --_btn-border: transparent;

  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--s-space-2);

  padding: var(--s-space-2) var(--s-space-4);
  border-radius: var(--s-radius-md);
  font-weight: var(--s-font-semibold);
  font-size: var(--s-text-sm);
  line-height: 1;
  white-space: nowrap;

  background-color: var(--_btn-bg);
  color: var(--_btn-text);
  border: 1px solid var(--_btn-border);

  /* Auto-contrast for custom backgrounds */
  @supports (color: oklch(from red l c h)) {
    color: oklch(
      from var(--_btn-bg) clamp(0.15, calc((0.6 - l) * 1000 + 0.15), 0.95) 0 0
    );
  }

  @supports (color: contrast-color(red)) {
    color: contrast-color(var(--_btn-bg));
  }

  /* Transitions */
  transition:
    background-color var(--s-duration-150) var(--s-ease-out),
    border-color var(--s-duration-150) var(--s-ease-out),
    transform var(--s-duration-100) var(--s-ease-out);

  cursor: pointer;
  user-select: none;

  /* Hover state */
  &:hover:not(:disabled) {
    --_btn-bg: var(--s-interactive-primary-hover);
  }

  /* Active state */
  &:active:not(:disabled) {
    --_btn-bg: var(--s-interactive-primary-active);
    transform: scale(0.98);
  }

  /* Focus state */
  &:focus-visible {
    outline: 2px solid var(--s-focus-ring);
    outline-offset: 2px;
  }

  /* Disabled state */
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }
}

/* =============================================================================
   BUTTON VARIANTS (0,1,0 specificity - slightly sticky)
   ============================================================================= */

/* Primary - default, explicit declaration */
[s-btn="primary"] {
  --_btn-bg: var(--s-interactive-primary);
  --_btn-text: var(--s-text-inverse);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-interactive-primary-hover);
  }

  &:active:not(:disabled) {
    --_btn-bg: var(--s-interactive-primary-active);
  }
}

/* Secondary */
[s-btn="secondary"] {
  --_btn-bg: var(--s-surface-raised);
  --_btn-text: var(--s-text-primary);
  --_btn-border: var(--s-border-default);

  /* Override auto-contrast */
  color: var(--_btn-text);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-surface-sunken);
  }
}

/* Ghost - transparent background */
[s-btn="ghost"] {
  --_btn-bg: transparent;
  --_btn-text: var(--s-interactive-primary);

  /* Override auto-contrast for transparent bg */
  color: var(--_btn-text);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-surface-sunken);
  }
}

/* Link - looks like a link */
[s-btn="link"] {
  --_btn-bg: transparent;
  --_btn-text: var(--s-interactive-primary);
  --_btn-border: transparent;

  color: var(--_btn-text);
  text-decoration: underline;
  text-underline-offset: 2px;

  &:hover:not(:disabled) {
    --_btn-text: var(--s-interactive-primary-hover);
    color: var(--_btn-text);
  }
}

/* Outline */
[s-btn="outline"] {
  --_btn-bg: transparent;
  --_btn-text: var(--s-interactive-primary);
  --_btn-border: var(--s-interactive-primary);

  color: var(--_btn-text);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-interactive-primary);
    --_btn-text: var(--s-text-inverse);
    color: var(--_btn-text);
  }
}

/* =============================================================================
   STATE VARIANTS
   ============================================================================= */

/* Danger */
[s-btn="danger"] {
  --_btn-bg: var(--s-state-danger);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-danger-800);
  }

  &:active:not(:disabled) {
    --_btn-bg: var(--s-danger-900);
  }
}

/* Success */
[s-btn="success"] {
  --_btn-bg: var(--s-state-success);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-success-800);
  }

  &:active:not(:disabled) {
    --_btn-bg: var(--s-success-900);
  }
}

/* Warning */
[s-btn="warning"] {
  --_btn-bg: var(--s-state-warning);

  &:hover:not(:disabled) {
    --_btn-bg: var(--s-warning-800);
  }

  &:active:not(:disabled) {
    --_btn-bg: var(--s-warning-900);
  }
}

/* =============================================================================
   SIZE MODIFIERS (composable via s-size attribute)
   ============================================================================= */

[s-btn][s-size="sm"] {
  padding: var(--s-space-1) var(--s-space-3);
  font-size: var(--s-text-xs);
}

[s-btn][s-size="lg"] {
  padding: var(--s-space-3) var(--s-space-6);
  font-size: var(--s-text-base);
}

[s-btn][s-size="xl"] {
  padding: var(--s-space-4) var(--s-space-8);
  font-size: var(--s-text-lg);
}

/* =============================================================================
   SPECIAL STATES
   ============================================================================= */

/* Icon-only button */
[s-btn][s-icon] {
  padding: var(--s-space-2);
  aspect-ratio: 1;
}

/* Full-width button */
[s-btn][s-block] {
  width: 100%;
}

/* Loading state */
[s-btn][s-loading] {
  position: relative;
  color: transparent;
  pointer-events: none;

  &::after {
    content: "";
    position: absolute;
    inset: 0;
    margin: auto;
    width: 1em;
    height: 1em;
    border: 2px solid var(--s-text-inverse);
    border-right-color: transparent;
    border-radius: 50%;
    animation: s-btn-spin 0.6s linear infinite;
  }
}

@keyframes s-btn-spin {
  to {
    transform: rotate(360deg);
  }
}

/* =============================================================================
   BUTTON GROUP
   ============================================================================= */

[s-btn-group] {
  display: inline-flex;

  & > [s-btn] {
    border-radius: 0;

    &:first-child {
      border-radius: var(--s-radius-md) 0 0 var(--s-radius-md);
    }

    &:last-child {
      border-radius: 0 var(--s-radius-md) var(--s-radius-md) 0;
    }

    &:not(:last-child) {
      border-right: none;
    }
  }
}
